# Appendix: Instructions for reproducing these analyses

Note that to re-run this analysis you'll need an anonymized copy of the data available in a subdirectory of the working directory. 

If you don't have the data you can use simulated data available in the [OSF repository](https://osf.io/7xhye/) for this project. Make sure that the subdirectories `all_null`, `main_effect` and/or `interaction` are subdirectories of the working directory.

You can re-run the analysis either with or without a software container that encapsulates all the software needed for analysis. Using the software container is the only method guaranteed to exactly match the results obtained by the authors. Instructions are provided below for both methods.

## Reproducing the analysis with the singularity software container

Make sure you have installed [Singularity version 3.5](https://sylabs.io/guides/3.5/user-guide/) and are at a command prompt in a directory containing the subdirectory with the anonymous data.

To re-run the full analysis, including the inferential statistics, use the `makeit analysis` command.  The command requires specifying the subdirectory containing the anonymized data through the shell variable `SUBDIR`.

Here is the main command to reproduce the analysis:

```
singularity exec library://dalejbarr/talklab/illusory-truth \ 
    makeit analysis SUBDIR=path-to-anonymized-data
```

where `path-to-anonymized-data` is replaced with the name of the subdirectory with the anonymous data (or one of the simulated versions of the data). Note that the inferential statistics can take very long to run, depending on the size of the dataset. For a large dataset, this can take more than 24 hours.

### Copying and editing the master R Markdown script

If you want to edit the master R Markdown script, the following command copies the script from the package into the file `my_analysis.Rmd` in the current working directory.

```
singularity exec library://dalejbarr/talklab/illusory-truth \
    makeit draft OUT=my_analysis.Rmd
```

You can then render the script via the container using:

```
singularity exec library://dalejbarr/talklab/illusory-truth \
    makeit render INFILE=my_analysis.Rmd SUBDIR=path-to-anonymized-data
```

altering `path-to-anonymized-data` as required.

## Reproducing the analysis without the singularity software container

The [R Markdown](https://rmarkdown.rstudio.com/index.html) source document used to create this file is included with the [truthiness](https://github.com/dalejbarr/truthiness) package (`devtools::install_github("dalejbarr/truthiness")`) that accompanies this project.  The software versions required are shown in the [Session Info](#sessinfo) section of this document. If any of your software does not match these versions, you are not guaranteed to match the results obtained by the authors.

If your only interest is in re-running the analysis, simply issue the following command within the R console.

```
truthiness::reproduce_analysis(path = "path-to-anonymized-data")
```

Replace `path-to-anonymized-data` with the name of the subdirectory containing the data. As noted in the above section, inferential stats may require a very long processing time.

### Accessing the master R Markdown script through RStudio

If you are using RStudio, simply go to the pull down menu 
`File -> New File... -> R Markdown...`, choose "From Template" in the left-hand options box and then choose "Illusory Truth Analysis" from the list of available templates.

Compile the R Markdown document to HTML using the 'Knit' button in RStudio. 

You can control where the process looks for the anonymized data by setting the value of `subdir` in the YAML header. See the example of YAML values below.

```
params:
  subdir: "path-to-anonymized-data"
  recipe: FALSE
```

### Accessing the master R Markdown script Without RStudio

The following command accesses the R Markdown script without RStudio.

```
rmarkdown::draft("my_analysis.Rmd", "illusory-truth-analysis", "truthiness")
```

This command will create the file `my_analysis.Rmd` in the working directory, which can then be edited and compiled.

Render to HTML using the following command from *`truthiness`*:

```
reproduce_analysis("path-to-anonymized-data", infile = "my_analysis.Rmd")
```

See `?truthiness::reproduce_analysis` for further options.
